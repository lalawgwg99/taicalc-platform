<!DOCTYPE html>
<html lang="zh-TW" class="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 æˆ¿è²¸è©¦ç®— (æ–°é’å®‰ç‰ˆ)ï½œTaiCalc</title>
    <meta name="description" content="2026 æ–°é’å®‰æˆ¿è²¸è©¦ç®—ã€‚æ”¯æ´å¯¬é™æœŸã€åˆ†æ®µåˆ©ç‡è¨ˆç®—ï¼Œç²¾æº–æ¨¡æ“¬è£œè²¼çµæŸå¾Œçš„æœˆä»˜é‡‘è®ŠåŒ–ã€‚æ¯”è¼ƒä¸€èˆ¬æˆ¿è²¸èˆ‡å„ªæƒ è²¸æ¬¾å·®ç•°ã€‚">
    <link rel="canonical" href="https://taicalc.com/tools/mortgage">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        stone: {
                            50: '#fafaf9',
                            800: '#292524',
                        }
                    }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
</head>

<body class="bg-stone-50 text-stone-800 min-h-screen flex flex-col font-sans">
    <div id="app" v-cloak class="flex-grow max-w-2xl mx-auto w-full px-4 sm:px-6 py-8">

        <!-- Header / Global Nav -->
        <nav class="flex items-center justify-between mb-8">
            <a href="../index.html" class="flex items-center gap-2 group">
                <span
                    class="text-xl font-bold tracking-tight text-stone-800 group-hover:text-amber-600 transition-colors">TaiCalc</span>
            </a>
            <div class="flex gap-4 sm:gap-6 text-sm font-medium text-stone-500">
                <a href="../index.html" class="hover:text-stone-900 transition-colors">é¦–é </a>
                <a href="../categories/tools.html" class="hover:text-stone-900 transition-colors">å·¥å…·</a>
            </div>
        </nav>

        <header class="mb-8">
            <div class="flex items-center justify-between mb-2">
                <h1 class="text-2xl sm:text-3xl font-bold text-stone-800 tracking-tight">æˆ¿è²¸è©¦ç®— (æ–°é’å®‰ç‰ˆ)</h1>
                <span
                    class="text-xs px-2.5 py-1 rounded-full bg-green-100 text-green-700 border border-green-200 font-medium">2026å¹´ç‰ˆ</span>
            </div>
            <p class="text-stone-500 text-sm">æ”¯æ´å¯¬é™æœŸèˆ‡åˆ†æ®µåˆ©ç‡ã€‚ç²¾æº–è¨ˆç®— 2026 æ–°é’å®‰è£œè²¼æˆªæ­¢å¾Œé‚„æ¬¾è®ŠåŒ–ã€‚</p>
        </header>

        <main class="space-y-6">

            <div class="card bg-white rounded-2xl shadow-sm border border-stone-200 overflow-hidden">
                <!-- Presets -->
                <div class="grid grid-cols-2 border-b border-stone-200">
                    <button @click="applyPreset('newYouth')"
                        class="py-3 text-sm font-bold text-center transition-colors hover:bg-green-50 text-green-700 border-r border-stone-100">
                        ğŸ  æ–°é’å®‰ 2026 (40å¹´)
                    </button>
                    <button @click="applyPreset('general')"
                        class="py-3 text-sm font-bold text-center transition-colors hover:bg-stone-50 text-stone-600">
                        ğŸ¦ ä¸€èˆ¬æˆ¿è²¸ (30å¹´)
                    </button>
                </div>

                <div class="p-6 space-y-6">

                    <!-- Basic Inputs -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="col-span-2">
                            <label class="block text-xs font-semibold text-stone-500 mb-1">è²¸æ¬¾ç¸½é¡ (è¬)</label>
                            <input type="number" v-model.number="amountWan"
                                class="w-full bg-stone-50 border border-stone-200 rounded-xl py-3 px-4 text-stone-800 text-xl font-bold focus:outline-none focus:ring-2 focus:ring-green-500/20 focus:border-green-500 transition-all">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-stone-500 mb-1">æœŸé™ (å¹´)</label>
                            <input type="number" v-model.number="years"
                                class="w-full bg-stone-50 border border-stone-200 rounded-xl py-3 px-4 text-stone-800 font-bold focus:outline-none focus:ring-2 focus:ring-green-500/20 focus:border-green-500">
                        </div>
                        <div>
                            <label class="block text-xs font-semibold text-stone-500 mb-1">å¯¬é™æœŸ (å¹´)</label>
                            <select v-model.number="graceYears"
                                class="w-full bg-stone-50 border border-stone-200 rounded-xl py-3 px-4 text-stone-800 font-bold focus:outline-none focus:ring-2 focus:ring-green-500/20 focus:border-green-500">
                                <option :value="0">ç„¡å¯¬é™æœŸ</option>
                                <option v-for="y in 5" :key="y" :value="y">{{ y }} å¹´</option>
                            </select>
                        </div>
                    </div>

                    <!-- Rate Settings -->
                    <div class="bg-stone-50 rounded-xl p-4 border border-stone-200 space-y-3">
                        <div class="flex items-center justify-between">
                            <h3 class="text-sm font-bold text-stone-700">åˆ©ç‡è¨­å®š (åˆ†æ®µå¼)</h3>
                            <button @click="twoStageMode = !twoStageMode" class="text-xs text-blue-600 hover:underline">
                                {{ twoStageMode ? 'åˆ‡æ›å–®ä¸€åˆ©ç‡' : 'å•Ÿç”¨åˆ†è«‡åˆ©ç‡ (è£œè²¼é€€å ´)' }}
                            </button>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-semibold text-stone-500 mb-1">
                                    {{ twoStageMode ? 'ç¬¬ä¸€æ®µåˆ©ç‡ (%)' : 'å¹´åˆ©ç‡ (%)' }}
                                </label>
                                <input type="number" v-model.number="rate1" step="0.005"
                                    class="w-full bg-white border border-stone-200 rounded-lg py-2 px-3 text-stone-800 font-bold focus:outline-none focus:ring-1 focus:ring-green-500">
                            </div>

                            <div v-if="twoStageMode">
                                <label class="block text-xs font-semibold text-stone-500 mb-1">ç¬¬äºŒæ®µåˆ©ç‡ (%)</label>
                                <input type="number" v-model.number="rate2" step="0.005"
                                    class="w-full bg-white border border-stone-200 rounded-lg py-2 px-3 text-stone-800 font-bold focus:outline-none focus:ring-1 focus:ring-green-500">
                            </div>
                        </div>

                        <div v-if="twoStageMode">
                            <label class="block text-xs font-semibold text-stone-500 mb-1">ç¬¬ä¸€æ®µæœŸé–“ (æœˆ)</label>
                            <div class="flex gap-2 items-center">
                                <input type="number" v-model.number="stage1Months"
                                    class="w-20 bg-white border border-stone-200 rounded-lg py-2 px-3 text-stone-800 font-bold focus:outline-none focus:ring-1 focus:ring-green-500">
                                <span class="text-xs text-stone-400">å€‹æœˆå¾Œè®Šæ›´ (å¦‚: 2026/8 é€€å ´å‰© 7 å€‹æœˆ)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Results -->
                    <div class="pt-4 border-t border-stone-100 grid gap-4">

                        <!-- Monthly Pay -->
                        <div
                            class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100 text-center">
                            <p class="text-xs text-green-700 uppercase tracking-wide mb-1">é ä¼°æœˆä»˜é‡‘</p>

                            <!-- Logic for Displaying Ranges -->
                            <div v-if="graceYears > 0">
                                <p class="text-sm font-medium text-green-600 mb-1">å¯¬é™æœŸå…§ ({{graceYears}}å¹´)</p>
                                <p class="text-3xl font-bold font-mono text-green-800 mb-3">${{ fmt(results.gracePay) }}
                                </p>

                                <div class="h-px bg-green-200 w-1/2 mx-auto my-3"></div>

                                <p class="text-sm font-medium text-green-600 mb-1">å¯¬é™æœŸå¾Œ</p>
                                <p class="text-2xl font-bold font-mono text-green-800">${{ fmt(results.afterGracePay) }}
                                </p>
                                <p v-if="twoStageMode && results.stage2Pay !== results.afterGracePay"
                                    class="text-xs text-green-600/70 mt-1">
                                    (åˆ©ç‡è®Šæ›´å¾Œ: ${{ fmt(results.stage2Pay) }})
                                </p>
                            </div>
                            <div v-else>
                                <p class="text-3xl font-bold font-mono text-green-800">${{ fmt(results.basePay) }}</p>
                                <p v-if="twoStageMode && results.stage2Pay !== results.basePay"
                                    class="text-sm text-green-600 mt-2">
                                    ç¬¬ {{stage1Months + 1}} å€‹æœˆèµ·: ${{ fmt(results.stage2Pay) }}
                                </p>
                            </div>
                        </div>

                        <!-- Summary Stats -->
                        <div class="grid grid-cols-2 gap-4 text-xs">
                            <div class="bg-stone-50 p-3 rounded-xl border border-stone-200">
                                <span class="block text-stone-400 mb-1">åˆ©æ¯ç¸½æ”¯å‡º</span>
                                <span class="block text-lg font-bold text-stone-700 font-mono">${{
                                    fmt(results.totalInterest) }}</span>
                            </div>
                            <div class="bg-stone-50 p-3 rounded-xl border border-stone-200">
                                <span class="block text-stone-400 mb-1">æœ¬æ¯ç¸½é¡</span>
                                <span class="block text-lg font-bold text-stone-700 font-mono">${{
                                    fmt(results.totalPayment) }}</span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Notes -->
            <div class="text-xs text-stone-400 space-y-1 opacity-80 px-2">
                <p>è¨»ï¼šè¨ˆç®—æ¡ç”¨æœ¬æ¯å¹³å‡æ”¤é‚„æ³•ã€‚</p>
                <p>æ–°é’å®‰è©¦ç®—é è¨­ï¼šå‰7å€‹æœˆ (è‡³2026/7) æœ‰è£œè²¼ï¼Œä¹‹å¾Œå›å¾©ä¸€èˆ¬åˆ©ç‡ã€‚</p>
            </div>
        </main>

        <footer class="text-center mt-12 text-stone-400 text-sm pb-8">
            Â© 2026 TaiCalc
        </footer>
    </div>

    <script>
        const { createApp, ref, computed, watch } = Vue

        createApp({
            setup() {
                const amountWan = ref(1000) // 1000è¬
                const years = ref(40)
                const graceYears = ref(5)

                const rate1 = ref(1.775)
                const rate2 = ref(2.15)
                const twoStageMode = ref(true)
                const stage1Months = ref(7) // Default to July 2026 (7 months from Jan 2026?) Jan, Feb.. July = 7 months.

                const applyPreset = (type) => {
                    if (type === 'newYouth') {
                        amountWan.value = 1000
                        years.value = 40
                        graceYears.value = 5
                        rate1.value = 1.775
                        rate2.value = 2.15
                        twoStageMode.value = true
                        stage1Months.value = 7
                    } else if (type === 'general') {
                        amountWan.value = 1200
                        years.value = 30
                        graceYears.value = 0
                        rate1.value = 2.185
                        twoStageMode.value = false
                    }
                }

                const fmt = (n) => n ? Math.round(n).toLocaleString('zh-TW') : '0'

                // Amortization (PMT)
                const PMT = (rateYear, nMonths, pv) => {
                    if (rateYear === 0) return pv / nMonths
                    const r = rateYear / 100 / 12
                    return pv * r * Math.pow(1 + r, nMonths) / (Math.pow(1 + r, nMonths) - 1)
                }

                const results = computed(() => {
                    const loan = (amountWan.value || 0) * 10000
                    const totalMonths = (years.value || 0) * 12
                    const graceMonths = (graceYears.value || 0) * 12

                    if (totalMonths <= 0) return {}

                    // Logic for Two Stage Rate + Grace Period
                    // This is complex because Rate Change can happen during or after Grace Period.
                    // New Youth: Grace 5 yr (60 mo). Rate Change at Month 7.
                    // So Rate Change happens DURING Grace Period.

                    let balance = loan
                    let totalInt = 0
                    let payGrace = 0
                    let payBase = 0 // Payment immediately after grace (or month 1)
                    let payStage2 = 0

                    const changeMonth = twoStageMode.value ? stage1Months.value : 99999

                    // Need to iterate? Or can we chunk? 
                    // To be robust, let's just iterate monthly. It's fast client side.
                    // Max 40 years = 480 months. Loop is cheap.

                    let r1 = rate1.value
                    let r2 = rate2.value || r1

                    let firstNonGracePay = 0
                    let firstPay = 0

                    for (let m = 1; m <= totalMonths; m++) {
                        // Determine Rate
                        const currentRateYear = (m <= changeMonth) ? r1 : r2
                        const r = currentRateYear / 100 / 12

                        // Interest for this month
                        const interest = balance * r
                        totalInt += interest

                        let principal = 0
                        let payment = 0

                        if (m <= graceMonths) {
                            // Grace Period: Pay Interest Only
                            payment = interest
                            if (m === 1) payGrace = payment // Capture initial grace pay
                            // If rate changes during grace, payGrace changes.
                            // We should probably display "Initial Grace Pay" and "Second Grace Pay" if applicable?
                            // For simplicity, just display Initial.
                        } else {
                            // Amortization Period
                            // Re-calculate PMT based on current balance, remaining months, current rate
                            const remaining = totalMonths - m + 1
                            payment = PMT(currentRateYear, remaining, balance)
                            principal = payment - interest
                            balance -= principal

                            if (firstNonGracePay === 0) firstNonGracePay = payment
                        }

                        if (m === 1) firstPay = payment
                        if (m === changeMonth + 1 && m > graceMonths) {
                            // Captured payment right after rate change (if in amortization)
                            payStage2 = payment
                        }
                        if (m > changeMonth && m <= graceMonths) {
                            // Rate changed during grace
                        }
                    }

                    // Refined Display Logic
                    // 1. Grace Pay: usually interest on full loan.
                    // If rate changes during grace, it changes. 
                    // The UI logic calculates `gracePay` using current rate1. 
                    const initialGrace = loan * (rate1.value / 100 / 12)

                    // 2. Pay Base (Amortization Start):
                    // If Grace >= ChangeMonth: Then amortization starts with Rate 2.
                    // If Grace < ChangeMonth: Amortization starts with Rate 1, then switches.

                    // Let's use the iterated values?
                    // Actually, let's just re-calculate specific snapshots for the UI.

                    // Snapshot 1: Initial Grace (if existing)
                    const snapGrace = initialGrace

                    // Snapshot 2: Initial Amortization (After Grace)
                    // what is the rate at (Grace + 1)?
                    const mStart = graceMonths + 1
                    const rStart = (mStart <= changeMonth) ? rate1.value : rate2.value
                    const payStart = PMT(rStart, totalMonths - graceMonths, loan)

                    // Snapshot 3: Stage 2 Amortization (if applicable)
                    // If ChangeMonth > GraceMonths, then payment changes at ChangeMonth + 1.
                    // We need balance at ChangeMonth.
                    // This requires iteration or formula. 
                    // Let's rely on the loop's `payStage2` if captured, or re-calc.
                    // If we didn't capture it (because change happened during grace), 
                    // then `payStart` is essentially the Stage 2 pay.

                    const finalPay = (changeMonth < graceMonths) ? payStart : payStage2 || payStart

                    // Correct `payStage2` for display:
                    // If rate changes AFTER Amortization starts, show it.
                    // If rate changes BEFORE Amortization starts (during grace), then `payStart` IS the new rate pay.

                    let displayStage2 = 0
                    if (twoStageMode.value && changeMonth > graceMonths) {
                        // Need to calculate balance at changeMonth to find new PMT
                        // Let's use a simpler heuristic for display or just use the loop result?
                        // The loop calculates total interest correctly.
                        // Let's assume loop is accurate enough if implemented right.
                        // But for `payStage2` display, we need to be careful.

                        // Re-run loop briefly to find PMT at changeMonth+1?
                        // actually `payStage2` variable in loop covers this? 
                        // Check loop: `if (m === changeMonth + 1 && m > graceMonths) payStage2 = payment`
                        // Yes.
                        displayStage2 = payStage2
                    }

                    return {
                        gracePay: snapGrace,
                        afterGracePay: payStart,
                        stage2Pay: displayStage2 || payStart, // fallback
                        basePay: payStart, // for non-grace scenario
                        totalInterest: totalInt,
                        totalPayment: loan + totalInt
                    }
                })

                return {
                    amountWan, years, graceYears,
                    rate1, rate2, twoStageMode, stage1Months,
                    results, applyPreset, fmt
                }
            }
        }).mount('#app')
    </script>
</body>

</html>