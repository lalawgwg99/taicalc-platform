<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¬ç®—äººç”Ÿï¼šè²¡å‹™è‡ªç”±å€’æ•¸ (FIRE Calculator)ï½œTaiCalc</title>
    <meta name="description" content="é‡åŒ–é‡‘éŒ¢èˆ‡è‡ªç”±çš„è·é›¢ã€‚è¨ˆç®—ä½ éœ€è¦å¤šå°‘è³‡ç”¢æ‰èƒ½ææ—©é€€ä¼‘ (FIRE)ï¼Œä¸¦æ¨¡æ“¬æ—¥å¸¸æ¶ˆè²»å°é€€ä¼‘æ™‚é–“çš„å½±éŸ¿ã€‚">
    <link rel="canonical" href="https://taicalc.com/tools/fire">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">

    <style>
        [v-cloak] {
            display: none;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f5f5f4;
            color: #1c1917;
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>

<body class="antialiased min-h-screen flex flex-col">

    <div id="app" v-cloak class="flex-grow w-full max-w-5xl mx-auto px-4 sm:px-6 py-8">

        <!-- Navigation -->
        <nav class="flex items-center justify-between mb-8">
            <a href="../index.html"
                class="flex items-center gap-2 group text-stone-600 hover:text-emerald-600 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m15 18-6-6 6-6" />
                </svg>
                <span class="font-bold tracking-tight">TaiCalc</span>
            </a>
            <div class="text-sm font-medium text-stone-400">
                æ¸¬ç®—äººç”Ÿ
            </div>
        </nav>

        <header class="mb-10 text-center">
            <div class="inline-flex items-center justify-center p-3 bg-white rounded-2xl shadow-sm mb-4">
                <span class="text-4xl">â³</span>
            </div>
            <h1 class="text-3xl sm:text-4xl font-bold text-stone-900 tracking-tight mb-3">è²¡å‹™è‡ªç”±å€’æ•¸</h1>
            <p class="text-stone-500 max-w-2xl mx-auto">
                åŸºæ–¼ 4% æ³•å‰‡ (The 4% Rule)ï¼Œè¨ˆç®—ä½ è·é›¢å¦‚æœä¸å·¥ä½œä¹Ÿèƒ½æ´»ä¸‹å»çš„ã€ŒFIREã€ç‹€æ…‹é‚„æœ‰å¤šé ã€‚<br>
                <span class="text-xs text-stone-400 mt-1 block">è¨»ï¼šé è¨­é€šè†¨ç‡ 2%ï¼ŒæŠ•è³‡å›å ±ç‡ç‚ºåç›®å›å ±ã€‚</span>
            </p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-8">

            <!-- Process / Input Section -->
            <div class="lg:col-span-4 space-y-6">

                <div class="bg-white rounded-2xl shadow-sm border border-stone-200 p-6">
                    <h2 class="text-lg font-bold text-stone-800 mb-5 flex items-center gap-2">
                        <span class="w-1 h-6 bg-emerald-500 rounded-full"></span>
                        ç¾æ³è¼¸å…¥
                    </h2>

                    <div class="space-y-5">
                        <!-- Age -->
                        <div>
                            <label
                                class="block text-xs font-bold text-stone-500 uppercase tracking-wider mb-1.5">ç¾åœ¨å¹´é½¡</label>
                            <input type="number" v-model.number="currentAge" class="input-base w-full text-lg"
                                placeholder="30">
                        </div>

                        <!-- Asset -->
                        <div>
                            <label class="block text-xs font-bold text-stone-500 uppercase tracking-wider mb-1.5">ç›®å‰æ·¨è³‡ç”¢
                                (TWD)</label>
                            <div class="relative">
                                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-stone-400">$</span>
                                <input type="number" v-model.number="currentNetWorth"
                                    class="input-base w-full pl-8 text-lg font-mono" placeholder="1000000">
                            </div>
                        </div>

                        <hr class="border-stone-100">

                        <!-- Monthly Expense -->
                        <div>
                            <label class="block text-xs font-bold text-stone-500 uppercase tracking-wider mb-1.5">ç›®æ¨™æœˆæ”¯å‡º
                                (é€€ä¼‘å¾Œ)</label>
                            <div class="relative">
                                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-stone-400">$</span>
                                <input type="number" v-model.number="monthlyExpense"
                                    class="input-base w-full pl-8 text-lg font-mono" placeholder="40000">
                            </div>
                            <p class="text-xs text-stone-400 mt-1">é€™æ±ºå®šäº†ä½ çš„è‡ªç”±é–€æª»ã€‚</p>
                        </div>

                        <!-- Monthly Savings -->
                        <div>
                            <label class="block text-xs font-bold text-stone-500 uppercase tracking-wider mb-1.5">æ¯æœˆèƒ½å­˜
                                (æŠ•å…¥æŠ•è³‡)</label>
                            <div class="relative">
                                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-stone-400">$</span>
                                <input type="number" v-model.number="monthlySavings"
                                    class="input-base w-full pl-8 text-lg font-mono" placeholder="20000">
                            </div>
                        </div>

                        <!-- Rate -->
                        <div>
                            <label
                                class="block text-xs font-bold text-stone-500 uppercase tracking-wider mb-1.5">é æœŸå¹´åŒ–å ±é…¬ç‡
                                (%)</label>
                            <div class="flex items-center gap-3">
                                <input type="range" v-model.number="annualReturn" min="1" max="15" step="0.5"
                                    class="flex-1 accent-emerald-600 h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer">
                                <span class="text-lg font-bold text-emerald-600 w-12 text-right">{{ annualReturn
                                    }}%</span>
                            </div>
                            <p class="text-xs text-stone-400 mt-1">å»ºè­°ï¼šä¿å®ˆ 4-5%ï¼Œç©æ¥µ 7-8% (æ‰£é™¤é€šè†¨å¾Œ)</p>
                        </div>
                    </div>
                </div>

                <!-- Coffee Simulator -->
                <div
                    class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl border border-amber-100 p-6 relative overflow-hidden">
                    <div class="relative z-10">
                        <div class="flex items-start justify-between mb-2">
                            <h3 class="font-bold text-amber-900">æ‹¿éµå› å­æ¨¡æ“¬</h3>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" v-model="coffeeMode" class="sr-only peer">
                                <div
                                    class="w-11 h-6 bg-amber-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-amber-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-600">
                                </div>
                            </label>
                        </div>
                        <p class="text-sm text-amber-800/80 mb-4">
                            æ¯å¤©å°‘å–ä¸€æ¯æ‹¿éµ ($150)ï¼Œèƒ½ææ—©å¤šä¹…é€€ä¼‘ï¼Ÿ
                        </p>

                        <div v-if="coffeeMode" class="bg-white/60 rounded-lg p-3 text-center animate-fade-in-up">
                            <p class="text-xs text-amber-800 mb-1">æ¯æœˆå¤šå­˜ $4,500ï¼Œè¤‡åˆ©æ•ˆæœ...</p>
                            <p class="text-xl font-bold text-amber-600">ææ—© {{ coffeeSavedYears }} å¹´ï¼</p>
                        </div>
                    </div>
                    <!-- Decoration -->
                    <div class="absolute -right-6 -bottom-6 text-9xl opacity-10 pointer-events-none">â˜•</div>
                </div>

            </div>

            <!-- Result Section -->
            <div class="lg:col-span-8 space-y-6">

                <!-- Main KPIs -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Target Block -->
                    <div class="bg-stone-900 text-white rounded-2xl p-6 shadow-xl relative overflow-hidden group">
                        <div class="absolute top-0 right-0 p-3 opacity-10 group-hover:opacity-20 transition-opacity">
                            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect width="20" height="14" x="2" y="5" rx="2" />
                                <line x1="2" x2="22" y1="10" y2="10" />
                            </svg>
                        </div>
                        <p class="text-stone-400 text-sm font-medium mb-1 uppercase tracking-wider">FIRE ç›®æ¨™è³‡ç”¢</p>
                        <p class="text-3xl sm:text-4xl font-bold font-mono text-emerald-400 mb-4">
                            ${{ fmt(fireNumber) }}
                        </p>
                        <div class="w-full bg-stone-800 h-2 rounded-full overflow-hidden">
                            <div class="bg-gradient-to-r from-emerald-600 to-emerald-400 h-full transition-all duration-1000"
                                :style="{ width: progressPercent + '%' }"></div>
                        </div>
                        <div class="flex justify-between mt-2 text-xs text-stone-500">
                            <span>ç›®å‰: ${{ fmt(currentNetWorth || 0) }}</span>
                            <span>{{ progressPercent }}%</span>
                        </div>
                    </div>

                    <!-- Countdown Block -->
                    <div
                        class="bg-white border border-stone-200 rounded-2xl p-6 shadow-sm flex flex-col justify-center items-center text-center relative overflow-hidden">
                        <div v-if="yearsToFreedom > 0 && yearsToFreedom < 100">
                            <p class="text-stone-500 text-sm font-medium mb-2">è·é›¢è²¡å‹™è‡ªç”±é‚„æœ‰</p>
                            <p class="text-5xl font-bold text-stone-800 font-mono tracking-tight leading-none mb-2">
                                {{ yearsToFreedom }} <span class="text-xl text-stone-400 font-sans font-normal">å¹´</span>
                            </p>
                            <p
                                class="text-sm text-emerald-600 font-medium bg-emerald-50 px-3 py-1 rounded-full inline-block">
                                {{ currentAge + yearsToFreedom }} æ­²é”æˆ
                            </p>
                        </div>
                        <div v-else-if="yearsToFreedom <= 0" class="flex flex-col items-center">
                            <span class="text-5xl mb-2">ğŸ‰</span>
                            <p class="text-xl font-bold text-stone-800">æ­å–œï¼æ‚¨å·²é”æˆè²¡å‹™è‡ªç”±</p>
                            <p class="text-sm text-stone-500 mt-1">æ‚¨çš„è³‡ç”¢ 4% å·²è¶³ä»¥è¦†è“‹é–‹éŠ·ã€‚</p>
                        </div>
                        <div v-else>
                            <span class="text-4xl mb-2">ğŸ¢</span>
                            <p class="text-stone-500">è·¯é€”é™é ï¼Œè«‹å¢åŠ å„²è“„æˆ–æé«˜å ±é…¬ç‡ã€‚</p>
                        </div>
                    </div>
                </div>

                <!-- Chart -->
                <div class="bg-white rounded-2xl shadow-sm border border-stone-200 p-6">
                    <h3 class="font-bold text-stone-800 mb-6 flex items-center justify-between">
                        è³‡ç”¢æˆé•·é æ¸¬
                        <span class="text-xs font-normal text-stone-400 bg-stone-100 px-2 py-1 rounded">è€ƒæ…®è¤‡åˆ©</span>
                    </h3>
                    <div class="w-full h-64 md:h-80 relative">
                        <canvas ref="fireChart"></canvas>
                    </div>
                </div>

                <!-- Analysis Cards -->
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <div class="bg-stone-50 rounded-xl p-4 border border-stone-100">
                        <p class="text-xs text-stone-500 mb-1">ä¸å·¥ä½œæœˆé ˜</p>
                        <p class="text-xl font-bold text-stone-700 font-mono">${{ fmt(Math.floor(currentNetWorth * 0.04
                            / 12)) }}</p>
                        <p class="text-[10px] text-stone-400">ç›®å‰è³‡ç”¢ç”¢ç”Ÿä¹‹è¢«å‹•æ”¶å…¥</p>
                    </div>
                    <div class="bg-stone-50 rounded-xl p-4 border border-stone-100">
                        <p class="text-xs text-stone-500 mb-1">ä¸»è¦å‹•åŠ›</p>
                        <p class="text-lg font-bold text-stone-700">
                            {{ monthlySavings > monthlyExpense ? 'å„²è“„åŠ›å¼· ğŸš€' : 'è¤‡åˆ©æ•ˆæ‡‰ ğŸ“ˆ' }}
                        </p>
                        <p class="text-[10px] text-stone-400">åŠ é€Ÿå› å­</p>
                    </div>
                    <div class="col-span-2 md:col-span-1 bg-stone-50 rounded-xl p-4 border border-stone-100">
                        <p class="text-xs text-stone-500 mb-1">è‡´å¯Œé—œéµ</p>
                        <p class="text-sm text-stone-600 leading-snug">
                            æ¯å¤šå­˜ 1 è¬å…ƒï¼Œå¯è®“é€€ä¼‘ææ—©
                            <span class="font-bold text-emerald-600">{{ saveMoreImpact }}</span> å¹´
                        </p>
                    </div>
                </div>

            </div>
        </main>

        <footer class="mt-12 text-center text-stone-400 text-sm pb-8 border-t border-stone-200 pt-8">
            <p class="mb-2"> TaiCalc </p>
            <p class="text-xs">æŠ•è³‡ä¸€å®šæœ‰é¢¨éšªï¼ŒFIRE è¨ˆç®—åƒ…ä¾›äººç”Ÿè¦åŠƒåƒè€ƒã€‚</p>
        </footer>

    </div>

    <script>
        const { createApp, ref, computed, watch, onMounted } = Vue

        // Tailwind Utils Input Style
        const inputClasses = "bg-stone-50 border border-stone-200 rounded-xl py-3 px-4 text-stone-800 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all placeholder:text-stone-300"
        document.querySelectorAll('.input-base').forEach(el => el.className += ' ' + inputClasses)

        createApp({
            setup() {
                // Inputs
                const currentAge = ref(30)
                const currentNetWorth = ref(0)
                const monthlyExpense = ref(40000)
                const monthlySavings = ref(15000)
                const annualReturn = ref(6) // %

                // Coffee Mode
                const coffeeMode = ref(false)

                // Chart instance
                const fireChart = ref(null)
                let chart = null

                // Format
                const fmt = (n) => n ? n.toLocaleString() : '0'

                // Computed
                const realSavings = computed(() => {
                    return monthlySavings.value + (coffeeMode.value ? 4500 : 0)
                })

                const fireNumber = computed(() => {
                    return (monthlyExpense.value * 12) * 25 // 4% Rule
                })

                const progressPercent = computed(() => {
                    if (fireNumber.value <= 0) return 100
                    return Math.min(100, Math.round((currentNetWorth.value / fireNumber.value) * 100))
                })

                // Core Logic: Calculate Years to Reach Target
                const calculateYearsToTarget = (start, target, monthlySave, rateYear) => {
                    if (start >= target) return 0
                    if (monthlySave <= 0 && start <= 0) return 999

                    const r = rateYear / 100 / 12

                    // Future Value Formula: FV = P * (1+r)^n + PMT * [((1+r)^n - 1) / r]
                    // Solve for n:
                    // This is complex algebra, usually solved by logarithm or iteration.
                    // Using NPER formula approximate: n = ln((FV * r + PMT) / (PV * r + PMT)) / ln(1 + r)

                    if (r === 0) {
                        return (target - start) / monthlySave / 12
                    }

                    const num = (target * r + monthlySave)
                    const den = (start * r + monthlySave)

                    if (den <= 0) return 999 // Should not happen with positive numbers

                    const nMonths = Math.log(num / den) / Math.log(1 + r)
                    const years = nMonths / 12

                    return years > 100 ? 100 : Math.ceil(years)
                }

                const yearsToFreedom = computed(() => {
                    return calculateYearsToTarget(
                        currentNetWorth.value,
                        fireNumber.value,
                        realSavings.value,
                        annualReturn.value
                    )
                })

                // Coffee Impact
                const coffeeSavedYears = computed(() => {
                    const baseYears = calculateYearsToTarget(currentNetWorth.value, fireNumber.value, monthlySavings.value, annualReturn.value)
                    const newYears = yearsToFreedom.value
                    return Math.max(0, (baseYears - newYears).toFixed(1))
                })

                // Extra 10k Impact
                const saveMoreImpact = computed(() => {
                    const baseYears = yearsToFreedom.value
                    const boostYears = calculateYearsToTarget(
                        currentNetWorth.value,
                        fireNumber.value,
                        realSavings.value + 10000,
                        annualReturn.value
                    )
                    return Math.max(0, (baseYears - boostYears).toFixed(1))
                })


                // Chart Update
                const updateChart = () => {
                    if (!chart) return

                    const labels = []
                    const data = []
                    const targetData = []

                    const years = Math.min(50, Math.ceil(yearsToFreedom.value) + 5) // Show 5 extra years
                    let balance = currentNetWorth.value
                    const r = annualReturn.value / 100 / 12
                    const save = realSavings.value

                    for (let y = 0; y <= years; y++) {
                        labels.push(currentAge.value + y)
                        targetData.push(fireNumber.value)

                        if (y === 0) {
                            data.push(balance)
                            continue
                        }

                        // Compound for 12 months
                        for (let m = 0; m < 12; m++) {
                            balance = balance * (1 + r) + save
                        }
                        data.push(Math.round(balance))
                    }

                    chart.data.labels = labels
                    chart.data.datasets[0].data = data
                    chart.data.datasets[1].data = targetData
                    chart.update()
                }

                watch([currentAge, currentNetWorth, monthlyExpense, realSavings, annualReturn], () => {
                    updateChart()
                    // Autosave (Optional, let's keep it simple first)
                })

                onMounted(() => {
                    const ctx = fireChart.value.getContext('2d')
                    chart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: [],
                            datasets: [
                                {
                                    label: 'è³‡ç”¢ç´¯ç©',
                                    data: [],
                                    borderColor: '#10b981', // Emerald 500
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    fill: true,
                                    tension: 0.4
                                },
                                {
                                    label: 'FIRE ç›®æ¨™',
                                    data: [],
                                    borderColor: '#ef4444', // Red 500
                                    borderDash: [5, 5],
                                    pointRadius: 0,
                                    borderWidth: 2
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                intersect: false,
                                mode: 'index',
                            },
                            scales: {
                                y: {
                                    grid: { color: '#f5f5f4' },
                                    ticks: {
                                        callback: (v) => '$' + (v / 10000).toFixed(0) + 'è¬'
                                    }
                                },
                                x: {
                                    grid: { display: false }
                                }
                            }
                        }
                    })
                    updateChart()
                })

                return {
                    currentAge, currentNetWorth, monthlyExpense, monthlySavings, annualReturn,
                    coffeeMode, fireChart,
                    yearsToFreedom, fireNumber, progressPercent, fmt,
                    coffeeSavedYears, saveMoreImpact
                }
            }
        }).mount('#app')
    </script>
</body>

</html>